"use strict";const ajaxURL="music-fc-ajax.php",patt=/^%[a-z](\d+)\^([\w\s]+)\/([\w\s]+)\^(\d+)[\s\d]+\?$/i;let isSwiping=!1,swipeID=null;function addClickListeners(){$("#start-btn").on("click",(function(e){e.preventDefault(),isSwiping||(isSwiping=!0,$(this).prop("disabled",!0),$("#done-btn").prop("disabled",!1),startSwipe(swipeID=parseInt($("#event-select").val())))})),$("#done-btn").on("click",(function(e){e.preventDefault(),isSwiping&&(isSwiping=!1,$(this).prop("disabled",!0),$("#start-btn").prop("disabled",!1),endSwipe(swipeID),swipeID=null)})),$("#swipe").on("input",(function(e){e.preventDefault(),e.stopImmediatePropagation();const s=$(this).val();let t=patt.exec(s);if(Array.isArray(t)){doAjax({action:"add-swipe",eventID:swipeID,fname:t[3].trim(),lname:t[2].trim(),cardNum:t[1].trim(),rawInput:s}).then(e=>{switch(parseInt(e)){case 1:setResultStatus(!0),$(this).val("");break;case 0:setResultStatus(!1),$(this).val("")}})}})),$("#swipe-card").on("submit",()=>!1)}function startSwipe(e){$("#swipe-state-1").html("Done"),$("#swipe-state-2").html("disable"),$("#event-select").prop("disabled",!0),$("#swipe").prop("disabled",!1),$("#swipe").focus()}function endSwipe(e){clearResultStatus(),$("#swipe-state-1").html("Begin"),$("#swipe-state-2").html("enable"),$("#swipe").prop("disabled",!0),$("#event-select").prop("disabled",!1)}function setResultStatus(e){clearResultStatus(),e?$("#swipe").addClass("form-control-success").parent().addClass("has-success"):$("#swipe").addClass("form-control-danger").parent().addClass("has-danger")}function clearResultStatus(){$("#swipe").removeClass("form-control-success form-control-danger").parent().removeClass("has-success has-danger")}async function doAjax(e){let s="";try{s=await $.ajax({url:ajaxURL,method:"post",data:e})}catch(e){console.error(e)}return s}$(document).ready((function(){addClickListeners()}));